<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ábaco Virtual de Inteiros</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            min-height: 100vh;
            background-color: #f0f0f0;
            color: #333;
        }

        /* --- TELA DE REFERÊNCIAS --- */
        #references-screen {
            display: flex; /* Mostrado por padrão */
            flex-direction: column;
            align-items: center;
            padding: 30px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            max-width: 700px;
            margin: 20px;
        }

        #references-screen h2 {
            text-align: left;
            width: 100%;
            border-bottom: 1px solid #ccc;
            padding-bottom: 10px;
        }

        .references-content {
            text-align: left;
            width: 100%;
            font-size: 0.9em;
            line-height: 1.5;
            margin-bottom: 25px;
        }

        .references-content p {
            margin-bottom: 1.2em;
        }

        #continue-btn {
            padding: 12px 30px;
            font-size: 1.2em;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            background-color: #5cb85c;
            color: white;
        }
        #continue-btn:hover {
            background-color: #4cae4c;
        }


        /* --- TELA DO ÁBACO --- */
        .abacus-container {
            /* display: flex; (original) */
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        /* ID para controlar a visibilidade do ábaco */
        #abacus-main {
            display: none; /* Começa escondido */
        }

        .display {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background-color: #e9ecef;
            border-radius: 8px;
            width: 250px;
        }

        .display h2 {
            margin: 0;
            font-size: 1.8em;
            color: #000;
        }

        .display #total-value {
            font-weight: bold;
            font-size: 1.5em;
        }

        .display .counts {
            display: flex;
            justify-content: space-around;
            margin-top: 10px;
            font-size: 0.9em;
        }

        .rods-wrapper {
            display: flex;
            justify-content: center;
            gap: 80px;
            margin-bottom: -15px;
            position: relative;
            z-index: 1;
        }

        .rod {
            width: 15px;
            height: 350px;
            background-color: #c0c0c0;
            border-radius: 8px 8px 0 0;
            position: relative;
            display: flex;
            flex-direction: column-reverse;
            align-items: center;
            padding-bottom: 5px;
        }

        .base {
            width: 300px;
            height: 30px;
            background-color: #8B4513;
            border-radius: 0 0 10px 10px;
            border: 2px solid #5a2d0c;
            position: relative;
            z-index: 0;
        }

        .disk {
            width: 60px;
            height: 35px;
            border-radius: 50%;
            margin-bottom: 5px;
            box-shadow: inset 0 -3px 5px rgba(0,0,0,0.3), 0 2px 3px rgba(0,0,0,0.2);
            transition: all 0.1s ease-in-out;
            flex-shrink: 0;
        }

        .disk.black {
            background-color: #222;
            border: 2px solid #000;
        }

        .disk.red {
            background-color: #d9534f;
            border: 2px solid #a94442;
        }

        .controls {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-top: 25px;
        }

        .control-group {
            text-align: center;
        }

        .control-group h3 {
            margin-top: 0;
            margin-bottom: 10px;
            font-weight: normal;
        }

        .control-group button {
            width: 50px;
            height: 50px;
            font-size: 2em;
            font-weight: bold;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: background-color 0.2s;
            margin: 0 5px;
        }

        .btn-add {
            background-color: #5cb85c;
            color: white;
        }
        .btn-add:hover {
            background-color: #4cae4c;
        }

        .btn-remove {
            background-color: #f0ad4e;
            color: white;
        }
        .btn-remove:hover {
            background-color: #ec971f;
        }
    </style>
</head>
<body>

    <div id="references-screen">
        <h2>5. Referências</h2>
        <div class="references-content">
            <p>BRASIL. Ministério da Educação. Secretaria de Educação Básica. <strong>Base Nacional Comum Curricular</strong>. Brasília: MEC, 2018.</p>
            
            <p>GODOI, Lucas Moraes. <strong>História na Educação Matemática: uma proposta didática com o Ábaco dos Números Inteiros</strong>. 2015. Trabalho de Conclusão de Curso (Licenciatura em Matemática) – Instituto de Matemática, Universidade Federal do Rio Grande do Sul, Porto Alegre, 2015.</p>
            
            <p>RIPOLL, Cydara Cavedon; WERMANN, Franciele Marciane Meinerz; BLUMBERG, Vanessa Pacheco; DOERING, Luisa Rodriguez. O Ábaco dos Inteiros, concreto e virtual, e os Tijolos Táteis. In: XI Bienal de Matemática, 2024, Porto Alegre. <strong>Anais [...]</strong>. Porto Alegre: SBM, 2024.</p>
            
            <p>SILVA, Erickson Gomes Imperador da; CONTI, Keli Cristina. O ábaco dos inteiros: auxílio aos estudantes na compreensão dos números negativos e suas operações. <strong>Revemat – Revista Eletrônica de Educação Matemática</strong>, Florianópolis, v. 11, n. 1, p. 74-83, 2016. DOI: https://doi.org/10.5007/1981-1322.2016v11n1p74</p>
        </div>
        <button id="continue-btn">Continuar</button>
    </div>

    <div class="abacus-container" id="abacus-main">
        
        <div class="display">
            <h2>Valor Total: <span id="total-value">0</span></h2>
            <div class="counts">
                <span id="count-left-display">Pretos (Positivos): 0</span>
                <span id="count-right-display">Vermelhos (Negativos): 0</span>
            </div>
        </div>

        <div class="rods-wrapper">
            <div class="rod" id="rod-left"></div>
            <div class="rod" id="rod-right"></div>
        </div>
        
        <div class="base"></div>

        <div class="controls">
            <div class="control-group">
                <h3>Positivos (Pretos)</h3>
                <button id="add-left" class="btn-add" title="Adicionar +1">+</button>
                <button id="remove-left" class="btn-remove" title="Remover +1">-</button>
            </div>
            <div class="control-group">
                <h3>Negativos (Vermelhos)</h3>
                <button id="add-right" class="btn-add" title="Adicionar -1">+</button>
                <button id="remove-right" class="btn-remove" title="Remover -1">-</button>
            </div>
        </div>

    </div>

    <script>
        // --- LÓGICA DA TELA DE REFERÊNCIAS ---
        const refScreen = document.getElementById('references-screen');
        const abacusMain = document.getElementById('abacus-main');
        const continueBtn = document.getElementById('continue-btn');

        continueBtn.addEventListener('click', () => {
            refScreen.style.display = 'none'; // Esconde as referências
            abacusMain.style.display = 'flex'; // Mostra o ábaco (usando 'flex' como no CSS original)
        });

        // --- LÓGICA ORIGINAL DO ÁBACO ---
        const rodLeft = document.getElementById('rod-left');
        const rodRight = document.getElementById('rod-right');

        const addLeftBtn = document.getElementById('add-left');
        const removeLeftBtn = document.getElementById('remove-left');
        const addRightBtn = document.getElementById('add-right');
        const removeRightBtn = document.getElementById('remove-right');

        const totalValueDisplay = document.getElementById('total-value');
        const countLeftDisplay = document.getElementById('count-left-display');
        const countRightDisplay = document.getElementById('count-right-display');

        let countLeft = 0;
        let countRight = 0;

        function updateDisplay() {
            const total = countLeft - countRight;
            totalValueDisplay.textContent = total;
            countLeftDisplay.textContent = `Pretos (Positivos): ${countLeft}`;
            countRightDisplay.textContent = `Vermelhos (Negativos): ${countRight}`;

            if (total < 0) {
                totalValueDisplay.style.color = '#d9534f';
            } else if (total > 0) {
                totalValueDisplay.style.color = '#333';
            } else {
                totalValueDisplay.style.color = '#777';
            }
        }

        function addDisk(rodElement, colorClass) {
            // Limite de 9 discos por haste
            if (rodElement.children.length >= 9) {
                return false; // Retorna falso se a haste estiver cheia
            }
            const disk = document.createElement('div');
            disk.classList.add('disk', colorClass);
            rodElement.appendChild(disk);
            return true; // Retorna verdadeiro se o disco foi adicionado
        }

        function removeDisk(rodElement) {
            if (rodElement.lastChild) {
                rodElement.removeChild(rodElement.lastChild);
            }
        }

        // Haste Esquerda (Pretos / Positivos)
        addLeftBtn.addEventListener('click', () => {
            // Tenta adicionar o disco
            if (addDisk(rodLeft, 'black')) {
                countLeft++; // Só incrementa se o disco foi adicionado
                updateDisplay();
            }
        });

        removeLeftBtn.addEventListener('click', () => {
            if (countLeft > 0) {
                countLeft--;
                removeDisk(rodLeft);
            } else {
                // Sem positivos → adiciona um negativo (se houver espaço)
                if (addDisk(rodRight, 'red')) {
                    countRight++;
                }
            }
            updateDisplay();
        });

        // Haste Direita (Vermelhos / Negativos)
        addRightBtn.addEventListener('click', () => {
            // Tenta adicionar o disco
            if (addDisk(rodRight, 'red')) {
                countRight++; // Só incrementa se o disco foi adicionado
                updateDisplay();
            }
        });

        removeRightBtn.addEventListener('click', () => {
            if (countRight > 0) {
                countRight--;
                removeDisk(rodRight);
            } else {
                // Sem negativos → adiciona um positivo (se houver espaço)
                if (addDisk(rodLeft, 'black')) {
                    countLeft++;
                }
            }
            updateDisplay();
        });

        updateDisplay();
    </script>
</body>
</html>
